function FrontBase(){}function Auth(){var t=this;t.maskWrapper=$(".mask-wrapper"),t.scrollWrapper=$(".scroll-wrapper"),t.smsCaptcha=$(".sms-captcha-btn")}FrontBase.prototype.listenAuthBoxHover=function(){var t=$(".auth-box"),e=$(".user-more-box");t.hover(function(){e.show()},function(){e.hide()})},FrontBase.prototype.run=function(){this.listenAuthBoxHover()},Auth.prototype.run=function(){var t=this;t.listenSHEvent(),t.listenSwitchEvent(),t.listenLoginEvent(),t.listenImgCaptchaEvent(),t.listenSmsCaptchaEvent(),t.listenRegistEvent()},Auth.prototype.showEvent=function(){this.maskWrapper.show()},Auth.prototype.hideEvent=function(){this.maskWrapper.hide()},Auth.prototype.listenSHEvent=function(){var t=this,e=$(".login-btn"),n=$(".regist-btn"),s=$(".close-btn");e.click(function(){t.scrollWrapper.css({left:0}),t.showEvent()}),n.click(function(){t.scrollWrapper.css({left:-400}),t.showEvent()}),s.click(function(){t.hideEvent()})},Auth.prototype.listenSwitchEvent=function(){var e=this;$(".switch").click(function(){var t=e.scrollWrapper.css("left");(t=parseInt(t))<0?e.scrollWrapper.animate({left:"0"}):e.scrollWrapper.animate({left:"-400px"})})},Auth.prototype.listenImgCaptchaEvent=function(){var t=$(".img-captcha");t.click(function(){t.attr("src","/account/img_captcha?random="+Math.random())})},Auth.prototype.listenLoginEvent=function(){var s=this,a=$('.signin-group input[name="telephone"]'),o=$('.signin-group input[name="password"]'),i=$('.signin-group input[name="remember"]');$(".signin-group .submit-btn").click(function(){var t=a.val(),e=o.val(),n=i.prop("checked");myajax.post({url:"/account/login/",data:{telephone:t,password:e,remember:n?1:0},success:function(t){s.hideEvent(),messageBox.showSuccess("登录成功",function(){setTimeout(window.location.reload())})}})})},Auth.prototype.listenRegistEvent=function(){$(".signup-group .submit-btn").click(function(t){console.log("click"),t.preventDefault();var e=$('.signup-group input[name="telephone"]'),n=$('.signup-group input[name="username"]'),s=$('.signup-group input[name="img_captcha"]'),a=$('.signup-group input[name="password1"]'),o=$('.signup-group input[name="password2"]'),i=$('.signup-group input[name="sms_captcha"]'),c=e.val(),r=n.val(),p=s.val(),u=a.val(),l=o.val(),h=i.val();myajax.post({url:"account/regist/",data:{telephone:c,username:r,img_captcha:p,password1:u,password2:l,sms_captcha:h},success:function(t){200==t.code&&window.location.reload()}})})},Auth.prototype.smsSuccessEvent=function(){var t=this;messageBox.showSuccess("验证码已发送，请注意查收！"),t.smsCaptcha.unbind(),t.smsCaptcha.addClass("disabled");var e=60,n=setInterval(function(){t.smsCaptcha.text(e+"s"),0==e&&(clearInterval(n),t.smsCaptcha.removeClass("disable"),t.smsCaptcha.text("发送验证码"),t.listenSmsCaptchaEvent()),e--},1e3)},Auth.prototype.listenSmsCaptchaEvent=function(){var e=this;e.smsCaptcha.click(function(){var t=$('.signup-group input[name="telephone"]').val();t?myajax.get({url:"/account/sms_captcha/",data:{telephone:t},success:function(t){200==t.code&&e.smsSuccessEvent()}}):messageBox.showError("请输入手机号码！")})},$(function(){(new Auth).run(),(new FrontBase).run()}),$(function(){window.template?template.defaults.imports.dateFormat=function(t){var e=new Date(t),n=e.getTime(),s=((new Date).getTime()-n)/1e3;return s<60?"刚刚":60<=s&&s<3600?parseInt(s/60)+"分钟前":3600<=s&&s<86400?parseInt(s/60/60)+"小时前":86400<=s&&s<2592e3?parseInt(s/60/60/24)+"天前":e.getFullYear()+"/"+e.getMonth()+"/"+e.getDate()+" "+e.getHours()+":"+e.getMinutes()+":"+e.getSeconds()}:console.log("arttemplate出错")});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImZyb250X2Jhc2UuanMiXSwibmFtZXMiOlsiRnJvbnRCYXNlIiwiQXV0aCIsInNlbGYiLCJ0aGlzIiwibWFza1dyYXBwZXIiLCIkIiwic2Nyb2xsV3JhcHBlciIsInNtc0NhcHRjaGEiLCJwcm90b3R5cGUiLCJsaXN0ZW5BdXRoQm94SG92ZXIiLCJhdXRoQm94IiwidXNlck1vcmVCb3giLCJob3ZlciIsInNob3ciLCJoaWRlIiwicnVuIiwibGlzdGVuU0hFdmVudCIsImxpc3RlblN3aXRjaEV2ZW50IiwibGlzdGVuTG9naW5FdmVudCIsImxpc3RlbkltZ0NhcHRjaGFFdmVudCIsImxpc3RlblNtc0NhcHRjaGFFdmVudCIsImxpc3RlblJlZ2lzdEV2ZW50Iiwic2hvd0V2ZW50IiwiaGlkZUV2ZW50IiwibG9naW5CdG4iLCJyZWdpc3RCdG4iLCJjbG9zZUJ0biIsImNsaWNrIiwiY3NzIiwibGVmdCIsImN1cnJlbnRMZWZ0IiwicGFyc2VJbnQiLCJhbmltYXRlIiwiaW1nQ2FwdGNoYSIsImF0dHIiLCJNYXRoIiwicmFuZG9tIiwidGVsZXRwaG9uZUlucHV0IiwicGFzc3dvcmRJbnB1dCIsInJlbWVtYmVySW5wdXQiLCJ0ZWxlcGhvbmUiLCJ2YWwiLCJwYXNzd29yZCIsInJlbWVtYmVyIiwicHJvcCIsIm15YWpheCIsInBvc3QiLCJ1cmwiLCJkYXRhIiwic3VjY2VzcyIsInJlc3VsdCIsIm1lc3NhZ2VCb3giLCJzaG93U3VjY2VzcyIsInNldFRpbWVvdXQiLCJ3aW5kb3ciLCJsb2NhdGlvbiIsInJlbG9hZCIsImV2ZW50IiwiY29uc29sZSIsImxvZyIsInByZXZlbnREZWZhdWx0IiwidGVsZXBob25lSW5wdXQiLCJ1c2VybmFtZUlucHV0IiwiaW1nX2NhcHRjaGFJbnB1dCIsInBhc3N3b3JkMUlucHV0IiwicGFzc3dvcmQySW5wdXQiLCJzbXNfY2FwdGNoYUlucHV0IiwidXNlcm5hbWUiLCJpbWdfY2FwdGNoYSIsInBhc3N3b3JkMSIsInBhc3N3b3JkMiIsInNtc19jYXB0Y2hhIiwic21zU3VjY2Vzc0V2ZW50IiwidW5iaW5kIiwiYWRkQ2xhc3MiLCJjb3VudCIsInRpbWVyIiwic2V0SW50ZXJ2YWwiLCJ0ZXh0IiwiY2xlYXJJbnRlcnZhbCIsInJlbW92ZUNsYXNzIiwiZ2V0Iiwic2hvd0Vycm9yIiwidGVtcGxhdGUiLCJkZWZhdWx0cyIsImltcG9ydHMiLCJkYXRlRm9ybWF0IiwiZGF0ZVZhbHVlIiwiZGF0ZSIsIkRhdGUiLCJkYXRldGltZXN0YW1wIiwiZ2V0VGltZSIsInRpbWVzdGFtcCIsImdldEZ1bGxZZWFyIiwiZ2V0TW9udGgiLCJnZXREYXRlIiwiZ2V0SG91cnMiLCJnZXRNaW51dGVzIiwiZ2V0U2Vjb25kcyJdLCJtYXBwaW5ncyI6IkFBQUEsU0FBU0EsYUFrQlQsU0FBU0MsT0FDTCxJQUFJQyxFQUFPQyxLQUNYRCxFQUFLRSxZQUFjQyxFQUFFLGlCQUNyQkgsRUFBS0ksY0FBZ0JELEVBQUUsbUJBQ3ZCSCxFQUFLSyxXQUFhRixFQUFFLG9CQXBCeEJMLFVBQVVRLFVBQVVDLG1CQUFxQixXQUNyQyxJQUFJQyxFQUFVTCxFQUFFLGFBQ1pNLEVBQWNOLEVBQUUsa0JBQ3BCSyxFQUFRRSxNQUFNLFdBQ1ZELEVBQVlFLFFBQ2IsV0FDQ0YsRUFBWUcsVUFJcEJkLFVBQVVRLFVBQVVPLElBQU0sV0FDWFosS0FDTk0sc0JBV1RSLEtBQUtPLFVBQVVPLElBQU0sV0FDakIsSUFBSWIsRUFBT0MsS0FDWEQsRUFBS2MsZ0JBQ0xkLEVBQUtlLG9CQUNMZixFQUFLZ0IsbUJBQ0xoQixFQUFLaUIsd0JBQ0xqQixFQUFLa0Isd0JBQ0xsQixFQUFLbUIscUJBR1RwQixLQUFLTyxVQUFVYyxVQUFZLFdBQ1puQixLQUNOQyxZQUFZUyxRQUdyQlosS0FBS08sVUFBVWUsVUFBWSxXQUNacEIsS0FDTkMsWUFBWVUsUUFHckJiLEtBQUtPLFVBQVVRLGNBQWdCLFdBQzNCLElBQUlkLEVBQU9DLEtBQ1BxQixFQUFXbkIsRUFBRSxjQUNib0IsRUFBWXBCLEVBQUUsZUFDZHFCLEVBQVdy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Q1BDLEtBQVEsQ0FDSlIsVUFBYUEsR0FFakJTLFFBQVcsU0FBU0MsR0FDSyxLQUFsQkEsRUFBYSxNQUNaaEQsRUFBS3NFLHFCQVRqQnJCLFdBQVcrQixVQUFVLGVBa0JqQzdFLEVBQUUsWUFDYSxJQUFJSixNQUNWYyxPQUVXLElBQUlmLFdBQ1ZlLFFBSWRWLEVBQUUsV0FDTWlELE9BQU82QixTQUNQQSxTQUFTQyxTQUFTQyxRQUFRQyxXQUFhLFNBQVVDLEdBQzdDLElBQUlDLEVBQU8sSUFBSUMsS0FBS0YsR0FDaEJHLEVBQWdCRixFQUFLRyxVQUVyQkMsSUFEZSxJQUFLSCxNQUFRRSxVQUNBRCxHQUFpQixJQUNqRCxPQUFJRSxFQUFZLEdBQ0wsS0FFVyxJQUFiQSxHQUFtQkEsRUFBWSxLQUN0QjdELFNBQVM2RCxFQUFZLElBQ2xCLE1BRUMsTUFBYkEsR0FBd0JBLEVBQVksTUFDN0I3RCxTQUFTNkQsRUFBWSxHQUFLLElBQ3ZCLE1BRUcsT0FBYkEsR0FBNkJBLEVBQVksT0FDbkM3RCxTQUFTNkQsRUFBWSxHQUFLLEdBQUssSUFDNUIsS0FFSEosRUFBS0ssY0FNRixJQUxGTCxFQUFLTSxXQUtXLElBSmxCTixFQUFLTyxVQUl5QixJQUg3QlAsRUFBS1EsV0FHcUMsSUFGeENSLEVBQUtTLGFBRWtELElBRHZEVCxFQUFLVSxjQU8xQnhDLFFBQVFDLElBQUkiLCJmaWxlIjoiZnJvbnRfYmFzZS5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyJmdW5jdGlvbiBGcm9udEJhc2UoKXt9XHJcblxyXG5Gcm9udEJhc2UucHJvdG90eXBlLmxpc3RlbkF1dGhCb3hIb3ZlciA9IGZ1bmN0aW9uKCl7XHJcbiAgICB2YXIgYXV0aEJveCA9ICQoJy5hdXRoLWJveCcpXHJcbiAgICB2YXIgdXNlck1vcmVCb3ggPSAkKCcudXNlci1tb3JlLWJveCcpXHJcbiAgICBhdXRoQm94LmhvdmVyKGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgdXNlck1vcmVCb3guc2hvdygpXHJcbiAgICB9LCBmdW5jdGlvbigpe1xyXG4gICAgICAgIHVzZXJNb3JlQm94LmhpZGUoKVxyXG4gICAgfSlcclxufVxyXG5cclxuRnJvbnRCYXNlLnByb3RvdHlwZS5ydW4gPSBmdW5jdGlvbigpe1xyXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgc2VsZi5saXN0ZW5BdXRoQm94SG92ZXIoKTtcclxufVxyXG5cclxuXHJcbmZ1bmN0aW9uIEF1dGgoKXtcclxuICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgIHNlbGYubWFza1dyYXBwZXIgPSAkKCcubWFzay13cmFwcGVyJyk7XHJcbiAgICBzZWxmLnNjcm9sbFdyYXBwZXIgPSAkKCcuc2Nyb2xsLXdyYXBwZXInKTtcclxuICAgIHNlbGYuc21zQ2FwdGNoYSA9ICQoJy5zbXMtY2FwdGNoYS1idG4nKTtcclxufVxyXG5cclxuQXV0aC5wcm90b3R5cGUucnVuID0gZnVuY3Rpb24oKXtcclxuICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgIHNlbGYubGlzdGVuU0hFdmVudCgpO1xyXG4gICAgc2VsZi5saXN0ZW5Td2l0Y2hFdmVudCgpO1xyXG4gICAgc2VsZi5saXN0ZW5Mb2dpbkV2ZW50KCk7XHJcbiAgICBzZWxmLmxpc3RlbkltZ0NhcHRjaGFFdmVudCgpO1xyXG4gICAgc2VsZi5saXN0ZW5TbXNDYXB0Y2hhRXZlbnQoKTtcclxuICAgIHNlbGYubGlzdGVuUmVnaXN0RXZlbnQoKTtcclxufVxyXG5cclxuQXV0aC5wcm90b3R5cGUuc2hvd0V2ZW50ID0gZnVuY3Rpb24oKXtcclxuICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgIHNlbGYubWFza1dyYXBwZXIuc2hvdygpXHJcbn1cclxuXHJcbkF1dGgucHJvdG90eXBlLmhpZGVFdmVudCA9IGZ1bmN0aW9uKCl7XHJcbiAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICBzZWxmLm1hc2tXcmFwcGVyLmhpZGUoKVxyXG59XHJcblxyXG5BdXRoLnByb3RvdHlwZS5saXN0ZW5TSEV2ZW50ID0gZnVuY3Rpb24oKXtcclxuICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgIHZhciBsb2dpbkJ0biA9ICQoJy5sb2dpbi1idG4nKTtcclxuICAgIHZhciByZWdpc3RCdG4gPSAkKCcucmVnaXN0LWJ0bicpO1xyXG4gICAgdmFyIGNsb3NlQnRuID0gJCgnLmNsb3NlLWJ0bicpO1xyXG4gICAgbG9naW5CdG4uY2xpY2soZnVuY3Rpb24oKXtcclxuICAgICAgICBzZWxmLnNjcm9sbFdyYXBwZXIuY3NzKHsnbGVmdCc6MH0pXHJcbiAgICAgICAgc2VsZi5zaG93RXZlbnQoKVxyXG4gICAgfSlcclxuXHJcbiAgICByZWdpc3RCdG4uY2xpY2soZnVuY3Rpb24oKXtcclxuICAgICAgICBzZWxmLnNjcm9sbFdyYXBwZXIuY3NzKHsnbGVmdCc6LTQwMH0pXHJcbiAgICAgICAgc2VsZi5zaG93RXZlbnQoKVxyXG4gICAgfSlcclxuXHJcbiAgICBjbG9zZUJ0bi5jbGljayhmdW5jdGlvbigpe1xyXG5cclxuICAgICAgICBzZWxmLmhpZGVFdmVudCgpXHJcbiAgICB9KVxyXG59XHJcblxyXG5BdXRoLnByb3RvdHlwZS5saXN0ZW5Td2l0Y2hFdmVudCA9IGZ1bmN0aW9uKCl7XHJcbiAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICB2YXIgc3dpdGNoZXIgPSAkKFwiLnN3aXRjaFwiKTtcclxuICAgIHN3aXRjaGVyLmNsaWNrKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgY3VycmVudExlZnQgPSBzZWxmLnNjcm9sbFdyYXBwZXIuY3NzKFwibGVmdFwiKTtcclxuICAgICAgICBjdXJyZW50TGVmdCA9IHBhcnNlSW50KGN1cnJlbnRMZWZ0KTtcclxuICAgICAgICBpZihjdXJyZW50TGVmdCA8IDApe1xyXG4gICAgICAgICAgICBzZWxmLnNjcm9sbFdyYXBwZXIuYW5pbWF0ZSh7XCJsZWZ0XCI6JzAnfSk7XHJcbiAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgIHNlbGYuc2Nyb2xsV3JhcHBlci5hbmltYXRlKHtcImxlZnRcIjpcIi00MDBweFwifSk7XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcbn1cclxuXHJcbkF1dGgucHJvdG90eXBlLmxpc3RlbkltZ0NhcHRjaGFFdmVudCA9IGZ1bmN0aW9uKCl7XHJcbiAgICB2YXIgaW1nQ2FwdGNoYSA9ICQoJy5pbWctY2FwdGNoYScpXHJcbiAgICBpbWdDYXB0Y2hhLmNsaWNrKGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgaW1nQ2FwdGNoYS5hdHRyKCdzcmMnLCcvYWNjb3VudC9pbWdfY2FwdGNoYT9yYW5kb209JyArIE1hdGgucmFuZG9tKCkpXHJcbiAgICB9KVxyXG59XHJcblxyXG5BdXRoLnByb3RvdHlwZS5saXN0ZW5Mb2dpbkV2ZW50ID0gZnVuY3Rpb24oKXtcclxuICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgIHZhciB0ZWxldHBob25lSW5wdXQgPSAkKCcuc2lnbmluLWdyb3VwIGlucHV0W25hbWU9XCJ0ZWxlcGhvbmVcIl0nKTtcclxuICAgIHZhciBwYXNzd29yZElucHV0ID0gJCgnLnNpZ25pbi1ncm91cCBpbnB1dFtuYW1lPVwicGFzc3dvcmRcIl0nKTtcclxuICAgIHZhciByZW1lbWJlcklucHV0ID0gJCgnLnNpZ25pbi1ncm91cCBpbnB1dFtuYW1lPVwicmVtZW1iZXJcIl0nKTtcclxuICAgIHZhciBsb2dpbkJ0biA9ICQoJy5zaWduaW4tZ3JvdXAgLnN1Ym1pdC1idG4nKTtcclxuICAgIGxvZ2luQnRuLmNsaWNrKGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgdmFyIHRlbGVwaG9uZSA9IHRlbGV0cGhvbmVJbnB1dC52YWwoKTtcclxuICAgICAgICB2YXIgcGFzc3dvcmQgPSBwYXNzd29yZElucHV0LnZhbCgpO1xyXG4gICAgICAgIHZhciByZW1lbWJlciA9IHJlbWVtYmVySW5wdXQucHJvcCgnY2hlY2tlZCcpO1xyXG4gICAgICAgIC8vIHZhciBjc3JmX3Rva2VuID0gJCgnc2lnbmluLWdyb3VwIGlucHV0W25hbWU9XCJjc3JmbWlkZGxld2FyZXRva2VuXCJdJykudmFsKCk7XHJcbiAgICAgICAgLy8gQWpheFxyXG4gICAgICAgIG15YWpheC5wb3N0KHtcclxuICAgICAgICAgICAgJ3VybCc6ICcvYWNjb3VudC9sb2dpbi8nLFxyXG4gICAgICAgICAgICAnZGF0YSc6IHtcclxuICAgICAgICAgICAgICAgICd0ZWxlcGhvbmUnOiB0ZWxlcGhvbmUsXHJcbiAgICAgICAgICAgICAgICAncGFzc3dvcmQnOiBwYXNzd29yZCxcclxuICAgICAgICAgICAgICAgICdyZW1lbWJlcic6IHJlbWVtYmVyPzE6MCxcclxuICAgICAgICAgICAgICAgIC8vICdjc3JmX3Rva2VuJzogY3NyZl90b2tlblxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAnc3VjY2Vzcyc6IGZ1bmN0aW9uIChyZXN1bHQpIHtcclxuICAgICAgICAgICAgICAgIHNlbGYuaGlkZUV2ZW50KCk7XHJcbiAgICAgICAgICAgICAgICBtZXNzYWdlQm94LnNob3dTdWNjZXNzKCfnmbvlvZXmiJDlip8nLCBmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQod2luZG93LmxvY2F0aW9uLnJlbG9hZCgpKVxyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pXHJcbiAgICB9KVxyXG5cclxufVxyXG5cclxuXHJcbkF1dGgucHJvdG90eXBlLmxpc3RlblJlZ2lzdEV2ZW50ID0gZnVuY3Rpb24oKXtcclxuICAgIHZhciBzdWJtaXRCdG4gPSAkKCcuc2lnbnVwLWdyb3VwIC5zdWJtaXQtYnRuJyk7XHJcbiAgICBzdWJtaXRCdG4uY2xpY2soZnVuY3Rpb24oZXZlbnQpe1xyXG4gICAgICAgIGNvbnNvbGUubG9nKCdjbGljaycpXHJcbiAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICB2YXIgdGVsZXBob25lSW5wdXQgPSAkKCcuc2lnbnVwLWdyb3VwIGlucHV0W25hbWU9XCJ0ZWxlcGhvbmVcIl0nKTtcclxuICAgICAgICB2YXIgdXNlcm5hbWVJbnB1dCA9ICQoJy5zaWdudXAtZ3JvdXAgaW5wdXRbbmFtZT1cInVzZXJuYW1lXCJdJyk7XHJcbiAgICAgICAgdmFyIGltZ19jYXB0Y2hhSW5wdXQgPSAkKCcuc2lnbnVwLWdyb3VwIGlucHV0W25hbWU9XCJpbWdfY2FwdGNoYVwiXScpO1xyXG4gICAgICAgIHZhciBwYXNzd29yZDFJbnB1dCA9ICQoJy5zaWdudXAtZ3JvdXAgaW5wdXRbbmFtZT1cInBhc3N3b3JkMVwiXScpO1xyXG4gICAgICAgIHZhciBwYXNzd29yZDJJbnB1dCA9ICQoJy5zaWdudXAtZ3JvdXAgaW5wdXRbbmFtZT1cInBhc3N3b3JkMlwiXScpO1xyXG4gICAgICAgIHZhciBzbXNfY2FwdGNoYUlucHV0ID0gJCgnLnNpZ251cC1ncm91cCBpbnB1dFtuYW1lPVwic21zX2NhcHRjaGFcIl0nKTtcclxuXHJcbiAgICAgICAgdmFyIHRlbGVwaG9uZSA9IHRlbGVwaG9uZUlucHV0LnZhbCgpO1xyXG4gICAgICAgIHZhciB1c2VybmFtZSA9IHVzZXJuYW1lSW5wdXQudmFsKCk7XHJcbiAgICAgICAgdmFyIGltZ19jYXB0Y2hhID0gaW1nX2NhcHRjaGFJbnB1dC52YWwoKTtcclxuICAgICAgICB2YXIgcGFzc3dvcmQxID0gcGFzc3dvcmQxSW5wdXQudmFsKCk7XHJcbiAgICAgICAgdmFyIHBhc3N3b3JkMiA9IHBhc3N3b3JkMklucHV0LnZhbCgpO1xyXG4gICAgICAgIHZhciBzbXNfY2FwdGNoYSA9IHNtc19jYXB0Y2hhSW5wdXQudmFsKCk7XHJcblxyXG4gICAgICAgIG15YWpheC5wb3N0KHtcclxuICAgICAgICAgICAgJ3VybCc6ICdhY2NvdW50L3JlZ2lzdC8nLFxyXG4gICAgICAgICAgICAnZGF0YSc6e1xyXG4gICAgICAgICAgICAgICAgJ3RlbGVwaG9uZSc6IHRlbGVwaG9uZSxcclxuICAgICAgICAgICAgICAgICd1c2VybmFtZSc6IHVzZXJuYW1lLFxyXG4gICAgICAgICAgICAgICAgJ2ltZ19jYXB0Y2hhJzogaW1nX2NhcHRjaGEsXHJcbiAgICAgICAgICAgICAgICAncGFzc3dvcmQxJzogcGFzc3dvcmQxLFxyXG4gICAgICAgICAgICAgICAgJ3Bhc3N3b3JkMic6IHBhc3N3b3JkMixcclxuICAgICAgICAgICAgICAgICdzbXNfY2FwdGNoYSc6IHNtc19jYXB0Y2hhXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICdzdWNjZXNzJzogZnVuY3Rpb24ocmVzdWx0KXtcclxuICAgICAgICAgICAgICAgIGlmKHJlc3VsdFsnY29kZSddID09IDIwMCl7XHJcbiAgICAgICAgICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uLnJlbG9hZCgpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KVxyXG4gICAgfSlcclxuXHJcbn1cclxuXHJcblxyXG5BdXRoLnByb3RvdHlwZS5zbXNTdWNjZXNzRXZlbnQgPSBmdW5jdGlvbigpe1xyXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgbWVzc2FnZUJveC5zaG93U3VjY2Vzcygn6aqM6K+B56CB5bey5Y+R6YCB77yM6K+35rOo5oSP5p+l5pS277yBJylcclxuICAgIHNlbGYuc21zQ2FwdGNoYS51bmJpbmQoKTtcclxuICAgIHNlbGYuc21zQ2FwdGNoYS5hZGRDbGFzcygnZGlzYWJsZWQnKTtcclxuICAgIHZhciBjb3VudCA9IDYwO1xyXG4gICAgdmFyIHRpbWVyID0gc2V0SW50ZXJ2YWwoZnVuY3Rpb24oKXtcclxuICAgICAgICBzZWxmLnNtc0NhcHRjaGEudGV4dChjb3VudCArICdzJylcclxuICAgICAgICBpZiAoY291bnQgPT0gMCl7XHJcbiAgICAgICAgICAgIGNsZWFySW50ZXJ2YWwodGltZXIpO1xyXG4gICAgICAgICAgICBzZWxmLnNtc0NhcHRjaGEucmVtb3ZlQ2xhc3MoJ2Rpc2FibGUnKTtcclxuICAgICAgICAgICAgc2VsZi5zbXNDYXB0Y2hhLnRleHQoJ+WPkemAgemqjOivgeeggScpO1xyXG4gICAgICAgICAgICBzZWxmLmxpc3RlblNtc0NhcHRjaGFFdmVudCgpXHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvdW50IC0tO1xyXG4gICAgfSwxMDAwKVxyXG59XHJcblxyXG5cclxuQXV0aC5wcm90b3R5cGUubGlzdGVuU21zQ2FwdGNoYUV2ZW50ID0gZnVuY3Rpb24oKXtcclxuICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgIHNlbGYuc21zQ2FwdGNoYS5jbGljayhmdW5jdGlvbigpe1xyXG4gICAgICAgIHZhciB0ZWxlcGhvbmVJbnB1dCA9ICQoJy5zaWdudXAtZ3JvdXAgaW5wdXRbbmFtZT1cInRlbGVwaG9uZVwiXScpO1xyXG4gICAgICAgIHZhciB0ZWxlcGhvbmUgPSB0ZWxlcGhvbmVJbnB1dC52YWwoKTtcclxuICAgICAgICBpZiAoIXRlbGVwaG9uZSl7XHJcbiAgICAgICAgICAgIG1lc3NhZ2VCb3guc2hvd0Vycm9yKCfor7fovpPlhaXmiYvmnLrlj7fnoIHvvIEnKVxyXG4gICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICBteWFqYXguZ2V0KHtcclxuICAgICAgICAgICAgICAgICd1cmwnOiAnL2FjY291bnQvc21zX2NhcHRjaGEvJyxcclxuICAgICAgICAgICAgICAgICdkYXRhJzoge1xyXG4gICAgICAgICAgICAgICAgICAgICd0ZWxlcGhvbmUnOiB0ZWxlcGhvbmVcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAnc3VjY2Vzcyc6IGZ1bmN0aW9uKHJlc3VsdCl7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYocmVzdWx0Wydjb2RlJ10gPT0gMjAwKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5zbXNTdWNjZXNzRXZlbnQoKVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSlcclxuICAgICAgICB9XHJcblxyXG4gICAgfSlcclxufVxyXG5cclxuJChmdW5jdGlvbigpe1xyXG4gICAgdmFyIGF1dGggPSBuZXcgQXV0aCgpXHJcbiAgICBhdXRoLnJ1bigpXHJcblxyXG4gICAgdmFyIGZyb250QmFzZSA9IG5ldyBGcm9udEJhc2UoKTtcclxuICAgIGZyb250QmFzZS5ydW4oKTtcclxufSlcclxuXHJcblxyXG4kKGZ1bmN0aW9uICgpIHtcclxuICAgIGlmICh3aW5kb3cudGVtcGxhdGUpIHtcclxuICAgICAgICB0ZW1wbGF0ZS5kZWZhdWx0cy5pbXBvcnRzLmRhdGVGb3JtYXQgPSBmdW5jdGlvbiAoZGF0ZVZhbHVlKSB7XHJcbiAgICAgICAgICAgIHZhciBkYXRlID0gbmV3IERhdGUoZGF0ZVZhbHVlKTtcclxuICAgICAgICAgICAgdmFyIGRhdGV0aW1lc3RhbXAgPSBkYXRlLmdldFRpbWUoKTtcclxuICAgICAgICAgICAgdmFyIG5vd3RpbWVzdGFtcCA9IChuZXcgRGF0ZSgpKS5nZXRUaW1lKCk7XHJcbiAgICAgICAgICAgIHZhciB0aW1lc3RhbXAgPSAobm93dGltZXN0YW1wIC0gZGF0ZXRpbWVzdGFtcCkgLyAxMDAwOyAvLyDlvpfliLDnp5LmlbBcclxuICAgICAgICAgICAgaWYgKHRpbWVzdGFtcCA8IDYwKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gJ+WImuWImidcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIGlmICh0aW1lc3RhbXAgPj0gNjAgJiYgdGltZXN0YW1wIDwgNjAgKiA2MCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIG1pbnV0ZXMgPSBwYXJzZUludCh0aW1lc3RhbXAgLyA2MCk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbWludXRlcyArICfliIbpkp/liY0nO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2UgaWYgKHRpbWVzdGFtcCA+PSA2MCAqIDYwICYmIHRpbWVzdGFtcCA8IDYwICogNjAgKiAyNCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGhvdXJzID0gcGFyc2VJbnQodGltZXN0YW1wIC8gNjAgLyA2MCk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gaG91cnMgKyAn5bCP5pe25YmNJztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIGlmICh0aW1lc3RhbXAgPj0gNjAgKiA2MCAqIDI0ICYmIHRpbWVzdGFtcCA8IDYwICogNjAgKiAyNCAqIDMwKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgZGF5cyA9IHBhcnNlSW50KHRpbWVzdGFtcCAvIDYwIC8gNjAgLyAyNCk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZGF5cyArICflpKnliY0nO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdmFyIHllYXIgPSBkYXRlLmdldEZ1bGxZZWFyKCk7XHJcbiAgICAgICAgICAgICAgICB2YXIgbW9udGggPSBkYXRlLmdldE1vbnRoKCk7XHJcbiAgICAgICAgICAgICAgICB2YXIgZGF5ID0gZGF0ZS5nZXREYXRlKCk7XHJcbiAgICAgICAgICAgICAgICB2YXIgaG91ciA9IGRhdGUuZ2V0SG91cnMoKTtcclxuICAgICAgICAgICAgICAgIHZhciBtaW51dGUgPSBkYXRlLmdldE1pbnV0ZXMoKTtcclxuICAgICAgICAgICAgICAgIHZhciBzZWNvbmQgPSBkYXRlLmdldFNlY29uZHMoKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiB5ZWFyICsgJy8nICsgbW9udGggKyAnLycgKyBkYXkgKyAnICcgKyBob3VyICsgJzonICsgbWludXRlICsgJzonICsgc2Vjb25kO1xyXG4gICAgICAgICAgICB9XHJcblxyXG5cclxuICAgICAgICB9XHJcbiAgICB9ZWxzZXtcclxuICAgICAgICBjb25zb2xlLmxvZygnYXJ0dGVtcGxhdGXlh7rplJknKVxyXG4gICAgfVxyXG59KSJdfQ==
